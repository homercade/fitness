include ../../../templates/mem-head
block main   

  .container
    section.wrapper(style='margin-top:15px;')
      #info.col-md-5
        .content-panel
          center
            each pr in profs   
              img(src=`/assets/images/${pr.pic}`, alt="" width='128' height='128')
              .row
                a.btn.btn-success.btn-xs(data-toggle='modal', data-target='#add') 
                  i.fa.fa-edit
                  |  Edit        
              h4(style='margin-bottom:18px') #{pr.userfname} #{pr.userlname}
              a#edit.btn.btn-primary.btn-xs(style="position:relative; bottom:10px; cursor:pointer:") 
                i.fa.fa-edit
                |  Edit
              a#save.btn.btn-success.btn-xs(style="position:relative; bottom:10px; cursor:pointer; display:none; margin-right:5px") 
                |  Save Changes
              a#cancel.btn.btn-default.btn-xs(style="position:relative; bottom:10px; cursor:pointer; display:none;") 
                |  Cancel
              
              br
              br
              br
          h4 
            i.fa.fa-dumbbell(style="margin-right: 10px;")
            | Personal Information
          hr
          #fields
            .row
              .col-md-6
                h5 
                  b Address: 
              .col-md-6
              each pr in profs
                h5 #{pr.useraddress} 
            .row
              .col-md-6
                h5
                  b Gender:
              .col-md-6
              each pr in profs
                h5.ucwords #{pr.usergender}
            .row
              .col-md-6
                h5 
                  b Birthdate: 
              .col-md-6
              each pr in profs
                h5 #{pr.userbday}
                br
              
          
          #editFields(style='display:none')
            form.form-inline
            
              .row(style='margin-bottom:5px;')
              each pr in profs
                .form-group
                  label(style='margin-left:15px; font-weight:bold') Address: 
                  input#address.form-control(type="text" value = pr.useraddress , name='address' style='position:relative; right:-130px')
              .row(style='margin-bottom:5px;')
              each pr in profs
                .form-group
                  label(style='margin-left:15px;font-weight:bold') Contact: 
                  input#contact.form-control(type="text" value = pr.usermobile , name='contact' style='position:relative; right:-130px')
              .row(style='margin-bottom:5px;') 
              each pr in profs
                .form-group
                  label(style=' margin-left:15px;font-weight:bold') Email: 
                  input#email.form-control(type="email" value = pr.useremail , name='email' style='position:relative; right:-144px')
              .row(style='margin-bottom:5px;')
              each pr in profs
                .form-group
                  label(style=' margin-left:15px;font-weight:bold') Username: 
                  input#username.form-control(type="text" value = pr.userusername , name='username' style='position:relative; right:-115px')
              .row(style='margin-bottom:5px;')
              each pr in profs
                .form-group
                  label(style=' margin-left:15px;font-weight:bold') Password: 
                  input#password.form-control(type="password" value = pr.userpassword , name='password' style='position:relative; right:-120px')
              .row(style='margin-bottom:5px;')
              each pr in profs
                .form-group
                  label(style=' margin-left:15px;font-weight:bold') Confirm Password: 
                  input#rpassword.form-control(type="password" value = pr.userpassword , name='rpassword' style='position:relative; right:-66px')
              .row(style='margin-bottom:5px;')
                #prompt(style='margin-left:30px; margin-top:10px')
      #extra.col-md-7
        .content-panel
          h4 
            i.fa.fa-dumbbell(style="margin-right: 10px;")
            | Membership Information
          hr
          .row
            .col-md-6
              h5 
                b Membership Type: 
            .col-md-12
              center
                each pr in profs
                  h1 #{pr.memclassname} 
                    br 
                    | #{pr.membershipname}
                    br
                    br
              center
                each pr in profs  
                  h5 Last Paid on
                    b 
                      | #{pr.paymentdate}
                //- button.btn.btn-primary.btn-xs(style='margin-right: 5px')
                //-   i.fa.fa-snowflake
                //-   |
                //-   | Freeze
                //- button.btn.btn-success.btn-xs
                //-   i.fa.fa-level-up-alt 
                //-   |
                //-   | Upgrade 
                
          br
          .row
            .col-md-6
              h5 
                b Trainer Enrolled:
            .col-md-6
              
              each pr in profs
                if pr.trainerfname == undefined
                  h5 Not yet applied to a trainer. 
                    | 
                    a(href='trainers', style='cursor: pointer') Apply now?
                else 
                  h5 #{pr.trainerfname} #{pr.trainerlname}
          .row
            .col-md-6
              h5 
                b Member Since: 
            .col-md-6
              each pr in profs
                h5 #{pr.acceptdate}
          .row
            .col-md-6
              h5 
                b Membership Expiry: 
            .col-md-6
              each pr in profs
                h5 #{pr.expirydate}


        //add
      #add.modal.fade(tabindex='-1', role='dialog', aria-labelledby='myModalLabel', aria-hidden='true')
        .modal-dialog
          .modal-content
            .modal-header
              button.close(type='button', data-dismiss='modal', aria-hidden='true') Ã—
              h4#myModalLabel.modal-title Update Profile
            form.needs-validation(action='/member/pic/edit', method='POST', autocomplete='off' novalidate id='add-staff' enctype='multipart/form-data')
              .modal-body
                .container-fluid
                    .row
                      .col-md-4
                        | Upload your Image 
                        input#upload(type='file', name='img' ,accept="image/*")
              .modal-footer
                button.btn.btn-default(type='button', data-dismiss='modal') Close
                button.btn.btn-primary.addButton(type='submit' id='btn-add-staff') Save

include ../../../templates/foot
include ../../../templates/sub-foot

script.
  $('#edit').click(function(){
    $('#extra').hide();
    $('#edit').hide();
    $('#cancel').show();
    $('#save').show();
    $('#fields').hide();
    $('#editFields').show();

    $('#info').animate({
      'left':'28%'
    })
    
  })
  $('#cancel').click(function(){
    $('#extra').show();
    $('#edit').show();
    $('#cancel').hide();
    $('#save').hide();
    $('#fields').show();
    $('#editFields').hide();

    $('#info').animate({
      'left':'0%'
    })
  })

  $('#save').click(function(){
    
    if( $('#password').val() == $('#rpassword').val() ){

      $.post('/member/profile/edit', {
      address: $('#address').val(),
      contact: $('#contact').val(),
      email: $('#email').val(),
      username: $('#username').val(),
      password: $('#password').val()
      }).done(
        swal(
          'Succesful!',
          'You succesfully edited your profile.',
          'success'
        ).then((result) => {
          if (result.value){
            $('#prompt').text('')
            $('#editFields').hide();
            $('#fields').show();
            $('#save').hide();
            $('#cancel').hide();
            $('#edit').show();
            $('#extra').show();
            $('#info').animate({
              'left': '0%'
            })
          }
        })
      )
    }
    else{
      $('#prompt').text('Password did not match.').css({
        'color':'red',
        'font-weight':'bold'
      })
    }
  })

script.
  $(document).ready(function() {
      $('#btn-add-staff').bind("click",function() 
      { 
          var imgVal = $('#upload').val(); 
          if(imgVal=='') 
          { 
              alert("empty input file"); 
              return false; 
          } 




      }); 
  });